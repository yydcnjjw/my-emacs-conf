schema: spec-driven

context: |
  # Project Context

  ## Purpose
  Personal Emacs configuration (`my-emacs-conf`) designed to provide a customized, high-performance, and feature-rich editing environment. It aims to streamline development workflows (LSP, Tree-sitter), organizational tasks (Org Mode), and general text editing.

  ## Tech Stack
  - **Language:** Emacs Lisp (Elisp)
  - **Target Platform:** GNU Emacs 30+ (Native Compilation enabled)
  - **Package Manager:** `straight.el`
  - **Configuration Framework:** `use-package`

  ## Project Conventions

  ### Code Style
  - **File Headers:** Standard GNU Emacs Lisp headers (Author, Maintainer, Version, License GPLv3).
  - **Lexical Binding:** All files must enable lexical binding: `-*- lexical-binding: t -*-`.
  - **Directory Structure:**
      - `config/`: Feature-specific configuration files (e.g., `init-org.el`, `init-rust.el`).
      - `lib/`: Custom library code and helper functions (e.g., `my-org.el`, `my-loading.el`).
  - **Naming Conventions:**
      - Config files: `init-<feature>.el`.
      - Library files: `my-<library>.el`.
      - Custom symbols (functions/variables): Prefixed with `my/` (e.g., `my/root-dir`, `my/setup-org-latex-preview`).
  - **Loading:**
      - Use `(require 'init-<feature>)` or `(my/require-modules ...)` for loading modules.
      - Prefer lazy loading via `use-package` (`:defer t`, `:hook`, `:after`) to optimize startup time.

  ### Architecture Patterns
  - **Entry Point:** `init.el` bootstraps the environment, sets up `load-path` (adding `lib` and `config`), and loads the main configuration aggregator (`init-config`).
  - **Separation of Concerns:**
      - Configuration logic is strictly separated from library logic.
      - `init.el` files orchestrate packages using `use-package`.
      - `my-*.el` files contain the implementation details and custom logic.
  - **System Integration:** Uses `ensure-system-package` to verify and install external system dependencies.

  ### Testing Strategy
  - **Manual Verification:** Configuration changes are verified by usage.
  - **Performance:** `init-bench.el` is available for performance benchmarking and startup time analysis.

  ### Git Workflow
  - **Commit Style:** Follows **Conventional Commits** specification.
      - Structure: `<type>(<scope>): <description>`
      - Types: `feat`, `fix`, `refactor`, `config`, `docs`, `chore`, etc.
      - Examples:
          - `feat(snippets): update weeksummary and yasnippet configuration`
          - `refactor(im): rename and improve org time log item functions`
          - `config(telega): update proxy port to 8888`

  ## Domain Context
  - **Emacs Ecosystem:** Deep integration with core Emacs subsystems (Buffers, Windows, Frames).
  - **Org Mode:** Extensive customization including LaTeX preview, theme support, and download management.
  - **Development:** Full IDE capabilities via LSP (`init-lsp.el`) and Tree-sitter (`init-tm.el`, `my-treesit.el`) for languages like Rust, Python, PHP, and YAML.

  ## Important Constraints
  - **Performance:** High priority on startup speed and runtime responsiveness (`load-prefer-newer t`, native compilation).
  - **Environment:** Relies on local paths (`~/.emacs.d/`) and specific cache directories (`.cache/`).

  ## External Dependencies
  - **Core:** GNU Emacs (v30+ recommended).
  - **Package Management:** `straight.el` (bootstrapped automatically if missing).
  - **System Tools:**
      - `git`
      - `texlive` / `latexmk` (for Org LaTeX preview)
      - `ripgrep` (implied for search)
      - Language Servers (e.g., `intelephense` for PHP, `rust-analyzer` for Rust)

# Per-artifact rules (optional)
# Add custom rules for specific artifacts.
# Example:
#   rules:
#     proposal:
#       - Keep proposals under 500 words
#       - Always include a "Non-goals" section
#     tasks:
#       - Break tasks into chunks of max 2 hours
